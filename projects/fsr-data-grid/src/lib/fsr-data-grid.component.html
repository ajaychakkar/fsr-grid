<div class="fsr-grid-wrapper">
  <div class="fsr-grid-body-wrapper" *ngIf="_columnDefs.length > 0">
    <!-- Left pinned container -->
    <div class="fsr-left-pinned-container">
      <div class="fsr-header-row">
        <div class="fsr-header-rows-action-container" *ngIf="_gridOptions.rowExpandable || _gridOptions.rowSelection">
          <div *ngIf="_gridOptions.rowExpandable" (click)="expandCollapseAllRows()" class="actionable">
            <i class="fa fa-light {{ expandAllRows ? 'fa-chevron-down' : 'fa-chevron-right'}} font-size-12px"></i>
          </div>
          <div *ngIf="_gridOptions.rowSelection" class="actionable">
            <input type="checkbox" [(ngModel)]="selectAllRows" (change)="selectAll($event)"
              class="form-control-xs align-middle">
          </div>
        </div>
        <fsr-grid-column *ngFor="let column of leftPinnedColumns" [colDef]="column" fsrResizable
          [ngStyle]="{'width': column.$$width +'px'}" [resizable]="column.resizable!"
          (onResize)="onWidthResize($event, column)" (onResizeEnd)="onWidthResizeEnd($event, column)"
          (columnFilterChanged)="onColumnFilterChanged($event)" (columnSortChanged)="columnSortChanged($event)">
        </fsr-grid-column>
      </div>
      <div class="fsr-viewport-rows">
        <div *ngFor="let row of _rows">
          <div class="fsr-viewport-row-data">
            <div class="fsr-viewport-rows-action-container"  *ngIf="_gridOptions.rowExpandable || _gridOptions.rowSelection">
              <div *ngIf="_gridOptions.rowExpandable" class="actionable" (click)="onRowExpandCollapse(row)">
                <i class="fa fa-light {{ row.isExpanded ? 'fa-chevron-down' : 'fa-chevron-right'}} font-size-12px"></i>
              </div>
              <div *ngIf="_gridOptions.rowSelection" class="actionable">
                <input type="checkbox" [(ngModel)]="row.isSelected" (change)="rowSelectionChange($event, row)"
                  class="form-control-xs align-middle">
              </div>
            </div>
            <fsr-grid-row *ngIf="leftPinnedColumns.length" [data]="row.data" [isSelected]="row.isSelected"
              [ngClass]="{'fsr-row-selected' : row.isSelected}" [isExpanded]="row.isExpanded"
              [columns]="leftPinnedColumns" [rowSelection]="_gridOptions.rowSelection"
              [expandableDetail]="expandableDetail" [expandable]="_gridOptions.rowExpandable"
              (onRowClicked)="onRowClicked($event)">
            </fsr-grid-row>
          </div>
          <div *ngIf="expandableDetail && expandableDetail.template && row.isExpanded" class="row-expandable-wrapper"
            [style.height.px]="expandableDetail.expandableHeight!">
            <ng-template *ngIf="expandableDetail && expandableDetail.template"
              [ngTemplateOutlet]="expandableDetail.template"
              [ngTemplateOutletContext]="{data: row.data, expanded: row.isExpanded}">
            </ng-template>
          </div>
        </div>
      </div>
    </div>
    <!-- Viewport container -->
    <div class="fsr-viewport-container">
      <div class="fsr-header-row">
        <fsr-grid-column *ngFor="let column of viewPortColumns" fsrResizable fsrDraggable
        [ngStyle]="{'width': column.$$width +'px'}"
        [colDef]="column"
        [draggable]="column.draggable!"
        [dragColumn]="column"
        [resizable]="column.resizable!"
        (onResize)="onWidthResize($event, column)"
        (onResizeEnd)="onWidthResizeEnd($event, column)"
        (columnFilterChanged)="onColumnFilterChanged($event)"
        (columnSortChanged)="columnSortChanged($event)"
        (columnDragStart)="columnDragStart($event)"
        (columnDragging)="columnDragging($event)"
        (columnDragEnd)="columnDragEnd($event)">
        </fsr-grid-column>
      </div>
      <div class="fsr-viewport-rows">
        <div *ngFor="let row of _rows">
          <div class="fsr-viewport-row-data">
            <fsr-grid-row [data]="row.data" [isSelected]="row.isSelected" [isExpanded]="row.isExpanded"
              [ngClass]="{'fsr-row-selected' : row.isSelected}" [columns]="viewPortColumns"
              [rowSelection]="_gridOptions.rowSelection" [expandableDetail]="expandableDetail"
              [expandable]="_gridOptions.rowExpandable" (onRowClicked)="onRowClicked($event)">
            </fsr-grid-row>
          </div>
          <div *ngIf="expandableDetail && expandableDetail.template && row.isExpanded" class="row-expandable-wrapper"
            [style.height.px]="expandableDetail.expandableHeight!">
          </div>
        </div>
      </div>
    </div>
    <!-- Right pinned container -->
    <div class="fsr-right-pinned-container">
      <div class="fsr-header-row">
        <fsr-grid-column *ngFor="let column of rightPinnedColumns" [colDef]="column" fsrResizable
          [resizable]="column.resizable!" (onResize)="onWidthResize($event, column)"
          (onResizeEnd)="onWidthResizeEnd($event, column)" [ngStyle]="{'width': column.$$width +'px'}"
          (columnFilterChanged)="onColumnFilterChanged($event)" (columnSortChanged)="columnSortChanged($event)">
        </fsr-grid-column>
      </div>
      <div class="fsr-viewport-rows">
        <div *ngFor="let row of _rows">
          <div class="fsr-viewport-row-data">
            <fsr-grid-row [data]="row.data" [isSelected]="row.isSelected" [isExpanded]="row.isExpanded"
              [ngClass]="{'fsr-row-selected' : row.isSelected}" [columns]="rightPinnedColumns"
              [rowSelection]="_gridOptions.rowSelection" [expandableDetail]="expandableDetail"
              [expandable]="_gridOptions.rowExpandable" (onRowClicked)="onRowClicked($event)"
              (columnFilterChanged)="onColumnFilterChanged($event)">
            </fsr-grid-row>
          </div>
          <div *ngIf="expandableDetail && expandableDetail.template && row.isExpanded" class="row-expandable-wrapper"
            [style.height.px]="expandableDetail.expandableHeight!">
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="fsr-shimmer-wrapper" *ngIf="_columnDefs.length > 0 && loadingData">
    <div class="fsr-shimmer-row" *ngFor="let row of [1,2,3,4,5]" [ngClass]="_gridOptions.rowExpandable && _gridOptions.rowSelection ? 'ps-60' :  _gridOptions.rowExpandable || _gridOptions.rowSelection ? 'ps-30' : ''">
      <div class="fsr-shimmer-row-cells">
        <div class="fsr-shimmer-row-cell" *ngFor="let column of leftPinnedColumns"
          [ngStyle]="{'width': column.$$width +'px'}">
          <div class="bg-shimmer content"></div>
        </div>
      </div>

      <div class="fsr-shimmer-row-cells">
        <div class="fsr-shimmer-row-cell" *ngFor="let column of viewPortColumns"
          [ngStyle]="{'width': column.$$width +'px'}">
          <div class="bg-shimmer content"></div>
        </div>
      </div>

      <div class="fsr-shimmer-row-cells">
        <div class="fsr-shimmer-row-cell" *ngFor="let column of rightPinnedColumns"
          [ngStyle]="{'width': column.$$width +'px'}">
          <div class="bg-shimmer content"></div>
        </div>
      </div>
    </div>
  </div>
</div>
